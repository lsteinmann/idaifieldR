<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="idaifieldR">
<title>How to use this package: Detailed Workflow • idaifieldR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How to use this package: Detailed Workflow">
<meta property="og:description" content="idaifieldR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">idaifieldR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Demo.html">How to use this package: Detailed Workflow</a>
    <a class="dropdown-item" href="../articles/TLDR.html">TLDR: Essential Workflow</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lsteinmann/idaifieldR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>How to use this package: Detailed Workflow</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/lsteinmann/idaifieldR/blob/HEAD/vignettes/Demo.Rmd" class="external-link"><code>vignettes/Demo.Rmd</code></a></small>
      <div class="d-none name"><code>Demo.Rmd</code></div>
    </div>

    
    
<p>idaifieldR imports data from the <a href="https://github.com/dainst/idai-field" class="external-link">iDAI.field 2 / Field Desktop
database</a> into R. The core functions of this package use <a href="https://github.com/ropensci/sofa" class="external-link">sofa</a> (available on CRAN) to
connect to a running iDAI.field 2 or 3 (Field Desktop) client and store
the whole database in a list in R (in memory), avoiding the csv-export
that would otherwise be needed and gathering all documents at once,
which is not possible with said csv-export. Any R-Script using
idaifieldR to import the database can be re-run and updated with new
data flexibly without exporting from the Field client itself.</p>
<p>idaifieldR encompasses functionality to clean up and format the
imported list objects for easier processing in R. Using
<code><a href="../reference/simplify_idaifield.html">simplify_idaifield()</a></code>, the UUIDs can be replaced with the
appropriate identifiers, the geometry can be reformatted to be usable
with R-packages for spatial analysis such as <a href="https://cran.r-project.org/web/packages/sp/index.html" class="external-link">sp</a>, a
preferred language for multi-language input fields can be selected, and
more. Be aware that processing all resources from the database at once
can be slow for larger databases and uses up a lot of memory.</p>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>Since idaifieldR is not available on CRAN (yet), we need to install
it from GitHub. We can either download the current release from the <a href="https://github.com/lsteinmann/idaifieldR/releases" class="external-link">idaifieldR-GitHub
page</a> and <a href="https://riptutorial.com/r/example/5556/install-package-from-local-source" class="external-link">install
from the file</a>, or more conveniently use the <a href="https://cran.r-project.org/web/packages/devtools/index.html" class="external-link">devtools</a>
or <a href="https://cran.r-project.org/web/packages/remotes/" class="external-link">remotes</a>
package to install it from GitHub directly:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://remotes.r-lib.org" class="external-link">remotes</a></span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"lsteinmann/idaifieldR"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lsteinmann/idaifieldR" class="external-link">idaifieldR</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="loading-the-database-index">Loading the Database / Index<a class="anchor" aria-label="anchor" href="#loading-the-database-index"></a>
</h3>
<p>Our first step will be to load the complete database and create an
object that serves as the index for further processing. First, create a
connection object that will contain all the information R needs to
connect to the database server Field Desktop uses:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/connect_idaifield.html">connect_idaifield</a></span><span class="op">(</span>serverip <span class="op">=</span> <span class="st">"127.0.0.1"</span>, </span>
<span>                          pwd <span class="op">=</span> <span class="st">"hallo"</span><span class="op">)</span></span></code></pre></div>
<p>If you are using Field Desktop on the same computer, you should not
need the <code>serverip</code>-argument, as it defaults to the common
localhost address. Enter the password that is set in your Field
Desktop-Client under Tools/Werkzeuge &gt; Settings/Einstellungen: ‘Your
password’/‘Eigenes Passwort’ as <code>pwd</code>. See the documentation
for more info and additional arguments:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="fu"><a href="../reference/connect_idaifield.html">connect_idaifield</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>If you want to follow along with this tutorial directly using the
same data, load the backup file located at (‘<a href="https://github.com/lsteinmann/idaifieldR/blob/main/inst/testdata/rtest.jsonl" class="external-link">inst/testdata/rtest.jsonl</a>’)
from the GitHub repository into a new project called ‘rtest’ in you
Field Client. This demo dataset uses a very slightly customized project
configuration to demonstrate relevant functions.</p>
<p>You can get the complete rtest-dataset into R using the
<code><a href="../reference/get_idaifield_docs.html">get_idaifield_docs()</a></code>-function with the projects name
(<code>projectname</code>) and the connection-object named
<code>conn</code> that we created earlier (<code>connection</code>):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">idaifield_test_docs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_idaifield_docs.html">get_idaifield_docs</a></span><span class="op">(</span>connection <span class="op">=</span> <span class="va">conn</span>, </span>
<span>                                          projectname <span class="op">=</span> <span class="st">"rtest"</span><span class="op">)</span></span></code></pre></div>
<p>If you are using RStudio, you can get a convenient look at the result
using <code>View(idaifield_test_docs)</code> or by clicking on the list
in the Environment-window. It is a named nested list with the custom
class <code>idaifield_docs</code> that contains one element for each
resource in the database and reflects the original
<code>json</code>-structure. The name of each list is the identifier of
the associated resource. The <code>doc$resource</code> sub-list contains
the actual entry for each resource, while the other sub-lists contain
information about the changes made to each resource along with its basic
data such as the <em>UUID</em> that Field Desktop uses internally as the
unique name of each resource. You can use this list to visualize changes
made to database entries on a time axis sorted by users, etc., but we
will continue to utilize <code>idaifieldR</code>s functions to work with
the actual data.</p>
<p>Though it is not necessary for further processing, you can use
<code>idaifieldR</code>s <code><a href="../reference/check_and_unnest.html">check_and_unnest()</a></code>-function (see
<code>?check_and_unnest()</code>) to reduce the list to the resource
level:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">idaifield_test_resources</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/check_and_unnest.html">check_and_unnest</a></span><span class="op">(</span><span class="va">idaifield_test_docs</span><span class="op">)</span></span></code></pre></div>
<p>You will see that it is now an <code>idaifield_resources</code>
object and is taking up less memory. When browsing the object with
<code>View(idaifield_test_resources)</code> in RStudio, you can see that
is contains only the information of each ‘resource’, i.e. the actual
data you entered in Field Desktop. This step is automatically done by
<code>idaifieldR</code>-functions internally.</p>
<p>To get a very quick overview of our data, we generate an index of the
database that contains only the most basic information about each
object:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_uid_list.html">get_uid_list</a></span><span class="op">(</span><span class="va">idaifield_test_resources</span>, </span>
<span>                      verbose <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                      language <span class="op">=</span> <span class="st">"en"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">index</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="9%">
<col width="28%">
<col width="12%">
<col width="9%">
<col width="15%">
<col width="12%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="left">type</th>
<th align="left">UID</th>
<th align="left">identifier</th>
<th align="left">isRecordedIn</th>
<th align="left">liesWithin</th>
<th align="left">shortDescription</th>
<th align="left">liesWithinLayer</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Layer</td>
<td align="left">02932bc4-22ce-3080-a205-e050b489c0c2</td>
<td align="left">Befund_6</td>
<td align="left">Schnitt 1</td>
<td align="left">SE02</td>
<td align="left">Context 6</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">Survey</td>
<td align="left">031179fb-ac01-6b29-b6fc-b1b486d9bff8</td>
<td align="left">Surveyareal 1</td>
<td align="left">NA</td>
<td align="left">Weniger_schöner_Ort</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">Bone</td>
<td align="left">0324141a-8201-c5dc-631b-4dded4552ac4</td>
<td align="left">KNOCHEN_1</td>
<td align="left">Schnitt 1</td>
<td align="left">Grab_1</td>
<td align="left">Bone 1</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">Pottery</td>
<td align="left">0569d787-aa67-e105-3a27-cba29012e78e</td>
<td align="left">Befund_6_KER_4</td>
<td align="left">Schnitt 1</td>
<td align="left">Befund_6</td>
<td align="left">Befund 6 Pottery</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">RoomCeiling</td>
<td align="left">077a9be0-4cf4-4c99-af30-cb221c26ee05</td>
<td align="left">Decke</td>
<td align="left">Building</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">Pottery</td>
<td align="left">0860b5a5-4602-9feb-fabb-85610298bd93</td>
<td align="left">Befund_6_KER_18</td>
<td align="left">Schnitt 1</td>
<td align="left">Befund_6</td>
<td align="left">Befund 6 Pottery</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
<p>The <code>verbose = TRUE</code>-argument mainly includes the short
description entered in the database, while <code>language = "en"</code>
controls which language from the multi-language text input field is to
be used. Switch it so <code>language = "de"</code> to see the difference
with the demo data. We can produce our first plot from the index that
will give us a very general idea about our data. I am using the
pipe-operator from <code>dplyr</code> and <code>ggplot2</code> for
this:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">index</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">liesWithin</span>, fill <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Demo_files/figure-html/indexPlot-1.png" width="672"></p>
<p>As you can see, the demo data encompasses a variety of finds, that
are recorded in different “Layers” and “Trenches”. To get to the data
and produce some more useful plots, we will now simplify our
<code>idaifield_test_resources</code>-list.</p>
</div>
<div class="section level3">
<h3 id="simplify-the-list">Simplify the List<a class="anchor" aria-label="anchor" href="#simplify-the-list"></a>
</h3>
<p>The function <code><a href="../reference/simplify_idaifield.html">simplify_idaifield()</a></code> takes several
arguments that control the output. You can learn more about them in the
documentation (<code>?simplify_idaifield()</code>). Mostly, it should
suffice to use the defaults and only pass the imported
<code>idaifield_docs</code> or <code>idaifield_resources</code>
list.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">idaifield_test_simple</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simplify_idaifield.html">simplify_idaifield</a></span><span class="op">(</span><span class="va">idaifield_test_resources</span>, </span>
<span>                                            keep_geometry <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                            replace_uids <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                            uidlist <span class="op">=</span> <span class="va">index</span>,</span>
<span>                                            language <span class="op">=</span> <span class="st">"en"</span>,</span>
<span>                                            spread_fields <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Keeping input values of selected language ('en') where possible.</span></span></code></pre></div>
<p>The function will also notify you that it tries to use the English
values from multi-language input fields if possible. If the respective
input field has no English value, <code><a href="../reference/simplify_idaifield.html">simplify_idaifield()</a></code> will
use the next available language (in alphabetical order). If you wish to
keep all languages from the multi-language input fields, you can use
<code>language = "all"</code>. <code>keep_geometry = FALSE</code>
removes all coordinate information from the resources.
<code>replace_uids</code> is set to <code>TRUE</code> by default and
replaces UUIDs in the data with their corresponding identifiers to be
more readable. Checkbox fields as well as the campaign field are
automatically spread across multiple entries, so that they will be
stored in multiple columns in a matrix. If you dislike this behaviour,
set the argument <code>spread_fields</code> to <code>FALSE</code>. If
you process the complete database with this function, there is no need
to supply the index as we did just now, because it will generate its own
index. If, however, you choose to process only a subset of all data, you
need to supply an index of the complete database.</p>
<p>The list now has the <code>idaifield_simple</code> class. Browse the
resulting list by clicking on it in your Environment-window in RStudio
or use <code>View(idaifield_test_simple)</code>. All
<code>idaifield_...</code>-objects carry the connection and name of the
project as attributes with them for later use. You can view them with
<code>attributes(idaifield_test_simple)</code>.</p>
<p>If you wish to get the most out of you data, I recommend you use this
list and process it according to your own needs. However,
<code>idaifieldR</code> comes with a function that will turn the list
into a matrix. For this, it makes a lot of sense to select the data
first and get only the Pottery-resources that we want to work with. The
<code><a href="../reference/select_by.html">select_by()</a></code>-function from <code>idaifieldR</code> can do
this for us (see the documentation at <code>?select_by()</code>)</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pottery</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_by.html">select_by</a></span><span class="op">(</span><span class="va">idaifield_test_simple</span>, by <span class="op">=</span> <span class="st">"type"</span>, value <span class="op">=</span> <span class="st">"Pottery"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="queries">Queries<a class="anchor" aria-label="anchor" href="#queries"></a>
</h3>
<p>The same outcome can be achieved by querying the database directly.
See the documentation of <code>?idf_index_query()</code> and
<code>?idf_query()</code>. This may be useful when you frequently want
to update your data, but have a large amount of resources in the
database of which you only need a small subset:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pottery_docs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/idf_query.html">idf_query</a></span><span class="op">(</span><span class="va">conn</span>, </span>
<span>                          projectname <span class="op">=</span> <span class="st">"rtest"</span>, </span>
<span>                          field <span class="op">=</span> <span class="st">"type"</span>, </span>
<span>                          value <span class="op">=</span> <span class="st">"Pottery"</span><span class="op">)</span></span></code></pre></div>
<p>The query-functions will return <code>idaifield_docs</code>-lists
that (if you so wish) you still need to simplify. <strong>You need to
supply the index to the <code>uidlist</code>-argument, otherwise UUIDs
of relations cannot be replaced</strong>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pottery_simple</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simplify_idaifield.html">simplify_idaifield</a></span><span class="op">(</span><span class="va">pottery_docs</span>, uidlist <span class="op">=</span> <span class="va">index</span>, language <span class="op">=</span> <span class="st">"en"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="transform-the-lists-to-a-matrix-data-frame">Transform the Lists to a Matrix / data.frame<a class="anchor" aria-label="anchor" href="#transform-the-lists-to-a-matrix-data-frame"></a>
</h3>
<p>In both cases, you should now have an <code>idaifield_simple</code>
object with 37 elements. This, we will turn into a matrix, or directly
into a data.frame to make plots easier:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pottery</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/idaifield_as_matrix.html">idaifield_as_matrix</a></span><span class="op">(</span><span class="va">pottery</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>When viewing the resulting <code>Pottery</code>-data frame, you will
notice that the campaign-field has been converted to multiple columns.
If a custom configuration is present, this will happen to all custom
checkbox-fields, as there is no other way to conveniently deal with such
fields in a data frame. To make different or better use of it, try to
format the original list itself according to your needs.</p>
<p>From the data frame, we can produce some basic plots and take a look
at the distribution of periods across our layers:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pottery</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">relation.liesWithin</span>, fill <span class="op">=</span> <span class="va">period</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Demo_files/figure-html/potteryplot-1.png" width="672"></p>
<p>And another example:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pottery</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">vesselForm</span>, fill <span class="op">=</span> <span class="va">specificType</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Demo_files/figure-html/potteryplot2-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="languages">Languages<a class="anchor" aria-label="anchor" href="#languages"></a>
</h3>
<p>There are currently two functions that will make it easier to replace
the internal names of variables with their translations in different
languages:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">core_lang_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_language_list.html">download_language_list</a></span><span class="op">(</span>project <span class="op">=</span> <span class="st">"core"</span>, language <span class="op">=</span> <span class="st">"en"</span><span class="op">)</span></span>
<span><span class="va">milet_lang_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_language_list.html">download_language_list</a></span><span class="op">(</span>project <span class="op">=</span> <span class="st">"Milet"</span>, language <span class="op">=</span> <span class="st">"en"</span><span class="op">)</span></span></code></pre></div>
<p>Since these functions download the Language configuration from <a href="https://github.com/dainst/idai-field/tree/master/core/config" class="external-link">github.com/dainst/idai-field</a>,
I would advise you to safe the result in a local RDS-file after you
prepared everything. You can prepare a lookup-table like this:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lookup</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_language_lookup.html">get_language_lookup</a></span><span class="op">(</span><span class="va">core_lang_list</span>, language <span class="op">=</span> <span class="st">"en"</span><span class="op">)</span></span>
<span><span class="va">lookup</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">lookup</span>, <span class="fu"><a href="../reference/get_language_lookup.html">get_language_lookup</a></span><span class="op">(</span><span class="va">milet_lang_list</span>, language <span class="op">=</span> <span class="st">"en"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>To get the translations from the Project configuration, you can use
the config-attribute from any <code>idaifield_...</code>-list. This will
also give you an impression of how the lookup-table is set up:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">config</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">idaifield_test_simple</span>, <span class="st">"config"</span><span class="op">)</span></span>
<span><span class="va">lookup_conf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_language_lookup.html">get_language_lookup</a></span><span class="op">(</span><span class="va">config</span><span class="op">$</span><span class="va">languages</span>, language <span class="op">=</span> <span class="st">"en"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">lookup_conf</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">var</th>
<th align="left">label</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Testformular</td>
<td align="left">Testform</td>
</tr>
<tr class="even">
<td align="left">testCustomField</td>
<td align="left">englisch testCustomField</td>
</tr>
<tr class="odd">
<td align="left">testAnkreuzfeld</td>
<td align="left">Test Checkboxes</td>
</tr>
<tr class="even">
<td align="left">testBoolean</td>
<td align="left">english testBoolean</td>
</tr>
</tbody>
</table>
<p>You can use this to manually replace values for plots. The
translations from valuelists can currently not be imported, so this only
applies to the names of fields.</p>
</div>
<div class="section level2">
<h2 id="tldr">TLDR<a class="anchor" aria-label="anchor" href="#tldr"></a>
</h2>
<p>To make a long story short and sum it up, there are two ways that you
can get all your Pottery-resources into R. The following few lines are
always necessary:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/connect_idaifield.html">connect_idaifield</a></span><span class="op">(</span>pwd <span class="op">=</span> <span class="st">"hallo"</span><span class="op">)</span></span>
<span><span class="va">db</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_idaifield_docs.html">get_idaifield_docs</a></span><span class="op">(</span>connection <span class="op">=</span> <span class="va">conn</span>,</span>
<span>                         projectname <span class="op">=</span> <span class="st">"idaifieldr-demo"</span><span class="op">)</span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_uid_list.html">get_uid_list</a></span><span class="op">(</span><span class="va">db</span><span class="op">)</span></span></code></pre></div>
<p>Using the following few lines and all default arguments while
selecting from the whole database:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pottery</span> <span class="op">&lt;-</span> <span class="va">db</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/select_by.html">select_by</a></span><span class="op">(</span>by <span class="op">=</span> <span class="st">"type"</span>, value <span class="op">=</span> <span class="st">"Pottery"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Note: simplify_idaifield() needs the index of the complete project database </span></span>
<span>  <span class="co"># as a lookup-table to replace all UUIDs with their identifiers</span></span>
<span>  <span class="fu"><a href="../reference/simplify_idaifield.html">simplify_idaifield</a></span><span class="op">(</span>uidlist <span class="op">=</span> <span class="va">index</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/idaifield_as_matrix.html">idaifield_as_matrix</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Or using the following few lines with direct queries to the
database:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pottery</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/idf_query.html">idf_query</a></span><span class="op">(</span>connection <span class="op">=</span> <span class="va">conn</span>,</span>
<span>                     project <span class="op">=</span> <span class="st">"idaifieldr-demo"</span>, </span>
<span>                     field <span class="op">=</span> <span class="st">"type"</span>, </span>
<span>                     value <span class="op">=</span> <span class="st">"Pottery"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/idaifield_as_matrix.html">idaifield_as_matrix</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Lisa Steinmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
